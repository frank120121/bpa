!(function(){var dtmRoutine;(function(routine){var data={"resources":{"vtUrl":"https://developer.huawei.com/consumer/cn/service/josp/agc/WiseCloudDTMPortal/","id":"DTM-ac12610278cf1d9881791cae07875103"}};var I=function(){var e=data&&data.resources&&data.resources.id||"";return{getDtmLogId:function(){return e},warn:function(){var e=Array.prototype.slice.call(arguments).join("");e.length},error:function(){var e=Array.prototype.slice.call(arguments).join("");e.length}}}();var i=null;function j(e,t,r){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src=e;t&&(n.addEventListener?n.onload=t:n.onreadystatechange=function(){n.readyState in{loaded:!0,complete:!0}&&(n.onreadystatechange=null,t())});r&&(n.onerror=r);if(null===i){e=window.document.querySelector&&window.document.querySelector("script[nonce]");i="";if(e){r=e.nonce||e.getAttribute("nonce");r&&/^[\w+/_-]+[=]{0,2}$/.test(r)&&(i=r)}}i&&n.setAttribute("nonce",i);e=document.getElementsByTagName("script")[0]||document.body||document.head;e.parentNode.insertBefore(n,e)}function G(){return data&&data.resources&&data.resources.vtUrl||""}function D(){I.warn("[TAG] window property is overridden")}var q="function"==typeof window.addEventListener?window.addEventListener:D;var U=window.parent&&window.parent.postMessage&&"function"==typeof window.parent.postMessage?window.parent:{postMessage:D};var V=window.opener&&window.opener.postMessage&&"function"==typeof window.opener.postMessage?window.opener:{postMessage:D};var H={inquiry:function(){q("message",this._callback,!1);try{U.postMessage({type:"notify",code:"inIframe",options:{url:window.location.href,id:data&&data.resources&&data.resources.id||""}},"*")}catch(e){}},_makeValidUrl:function(e,t){var r="dist/static/vt/dtm-vt.js";var n={code:0,url:""};var i=document.getElementsByTagName("script");for(var a=0;a<i.length;a++)if(-1!==i[a].src.indexOf(r))return n.code=-1,n;if(e.publicId&&u!==e.publicId)n.code=-2;else if(e.vtHost)if(-1===t.indexOf(e.vtHost))n.code=-4;else{e=String.prototype.charAt.call(t,t.length-1);e=-1===e.indexOf("/")?"/":"";n.url=t+e+r}else n.code=-3;return n},_callback:function(e){e=e.data;if("iFrameOk"===e.status){var t=G();t="string"==typeof t?t:"";e=H._makeValidUrl(e,t);0===e.code?j(e.url,function(){try{U.postMessage({type:"notify",code:"vtLoaded",options:{url:window.location.href}},"*")}catch(e){}},function(){I.warn("[TAG] failed to load dtm vt js.")}):I.warn("[TAG] dtm vt url is wrong with "+e.code)}}};q("load",function(e){H.inquiry()},!0);var B=function(e){e=e.split("://");var t="http"===e[0].toLowerCase()?"http://":"https://";e=e[1].split("/");e=e[0];t+=e;return t}(G());var u=data&&data.resources&&data.resources.id||"";function W(e){this.code=String(e.code)||"pulse";e.extra&&(this.extra=e.extra);this.feedbackCB="function"==typeof e.feedBackCallback?e.feedBackCallback:function(e){};this.errorCB="function"==typeof e.errorCallback?e.errorCallback:function(e){};this.timeOut=Number(e.timeOut)||0}W.prototype.sendMessage=function(e){try{var t=String(e);var r={type:"r",code:this.code,ver:n.dtm_version,hash:t};this.extra&&(r.extra=this.extra);n.dtm_ext_enable?window.postMessage({code:"dtm-packet-to-portal",packet:r},window.location.origin):V.postMessage(r,B);return t}catch(e){return""}};var z=function(){var s=["dtm_version","dtm_digest","dtm_id","dtm_debug","dtm_lang","dtm_portal_ver","dtm_t","workspaceId"];var c=[!0,!0,!0,!1,!1,!1,!1,!1];function t(e){return Array.prototype.indexOf.call(s,e)}return{checkIfParamLegal:function(e){return 0<=t(e)},checkIfParamMandatory:function(e){e=t(e);return 0<=e&&!!c[e]},getQueryKeyList:function(){return s},justifyParams:function(e){var t;if(e.dtm_id&&e.dtm_id!==u)t="dtmMismatch";else{var r=[];for(var n=0;n<s.length;n++){var i=s[n];e[i]?r.push(c[n]):r.push(!1)}var a=r.join();var o=c.join();a===o?t="ok":0<=a.indexOf("true")&&(t="dtmParamMissing")}return t}}}();var K=function(){var e=["dtm_version","dtm_digest","dtm_debug","workspaceId"];return{getJsQueryKeyList:function(){return e}}}();var n=function(){var r=window.location.search;if(window[u])I.warn("[bootloader] preview "+u+" is duplicated!");else{var e=function(){var t={};if("?"===r[0]){r=r.substring(1);var e=r.split("&");Array.prototype.forEach.call(e,function(e){e=e.split("=");z.checkIfParamLegal(e[0])&&(t[e[0]]=e[1])})}return t}();if(!e.dtm_t){"{}"===JSON.stringify(e)&&(e=n()||{});var t=z.justifyParams(e);t&&(e.dtm_preview_err=t);return e}t=window.location.search;t=t.replace(/(&|\?)dtm_t=([0-9]+)/,"");"&"===t[0]&&(t=t.slice(1));t&&"?"!==t[0]&&(t="?"+t);t=window.location.origin+window.location.pathname+t+window.location.hash;window.location.replace(t)}function n(){var e=document.getElementsByTagName("head")[0];var t=e.getElementsByTagName("script");var r;for(var n=0;n<t.length;n++){var i=t[n];if(i.src&&-1!==i.src.indexOf("dtm.js?id=")){r=function(r){var n={};Array.prototype.forEach.call(z.getQueryKeyList(),function(e){var t=r.getAttribute(e);t&&(n[e]=t)});return n}(i);if(r.dtm_id===u){r.dtm_ext_enable=!0;break}}}return r}}();var a=function(){};routine&&void 0===routine.name&&(routine.name="dtmRoutine");a="function"==typeof routine&&"dtmRoutine"===routine.name?routine:a;function o(e){I.warn("[bootloader]","Error: failed to load preview: "+e);e=n.dtm_id||u;e=window[e]&&window[e].ballonTip;e&&"function"==typeof e.turnOff&&e.turnOff()}function F(e,t,r){var n=G();var i=String.prototype.charAt.call(n,n.length-1);i=-1===i.indexOf("/")?"/":"";n=n+i+"dist/static/pv/dtm-pv.js#id="+e;j(n,t,r)}if(n&&"ok"===n.dtm_preview_err){n.dtmLog=I;window[n.dtm_id]=n;n.dtmDebugReqQ={_requestQueue:{serialNo:0},_add:function(e,t){this._requestQueue[e]=t},_remove:function(e){if(this._requestQueue[e])return delete this._requestQueue[e],!0;return!1},triggerRequest:function(e){var t=new W(e);var r=t.sendMessage(this._requestQueue.serialNo);this._requestQueue.serialNo=(this._requestQueue.serialNo+1)%Number.MAX_SAFE_INTEGER;if(r){this._add(r,t);var n=this;t.timeOut&&setTimeout(function(){n._remove(r)&&t.errorCB("postMessage timeout")},t.timeOut)}else t.errorCB("postMessage exception")},feedBackHandle:function(e){var t=e.hash;var r=this._requestQueue[t];if(r){this._remove(t);r.code===e.code?r.feedbackCB(e):r.errorCB("feedback code:"+e.code+" is mismatched with "+r.code)}else e.code}};Object.defineProperty(window,n.dtm_id,{configurable:!1,writable:!1});Object.freeze(n.dtmDebugReqQ);q("message",function(e){"f"===e.data.type?n.dtmDebugReqQ.feedBackHandle(e.data):e.data.code},!1);var Z=function(e){for(var t=0;t<e.length;t++)if(-1!==e[t].src.indexOf("dtm.js?id=")&&0<=e[t].src.indexOf(u))return e[t].src;return""}(document.getElementsByTagName("script"));var Y=function(e){var t=function(e){e=e.split("#");var t=[];t.push(e[0].slice());e[0]="";t.push(e.join("#"));return t}(e);var r=t[0].split("&");if(-1===r[0].indexOf("dtm.js")){o("noDtmJs");a(I)}else{Array.prototype.forEach.call(K.getJsQueryKeyList(),function(e){n[e]&&r.push(e+"="+n[e])});e=r.join("&")+t[1];e=e.replace("/download/","/preview/");j(e,function(){},function(){o("missingVersion");n.dtmDebugReqQ.triggerRequest({code:"err",extra:{errInfo:"missing"},timeOut:1e3});a(I)})}};F(n.dtm_id,function(){Y(Z)},function(){o("missingDtmPv");n.dtmDebugReqQ.triggerRequest({code:"err",extra:{errInfo:"missing"},timeOut:1e3});Y(Z)})}else if(n){var J=n.dtm_preview_err;J&&"ok"!==J&&o(J);a(I)}})(dtmRoutine);})();